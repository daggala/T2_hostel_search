package hotelSearch;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.ArrayList;

public class BookingManager {
	
	private final String DB_DRIVER;
	private final String DB_CONNECTION;
	
	public BookingManager(){
		DB_DRIVER = "org.sqlite.JDBC";
		DB_CONNECTION = "jdbc:sqlite:/Users/dagny/Documents/HotelSearch/T2_hostel_search/HotelSearch/HotelData";
	}
	
	public void updateDB(Hotel hotel, Request request) throws ConnectException{

		Connection c = null;
	    PreparedStatement statement = null;
	    
	    ArrayList<String> dayList = new ArrayList<String>();
	    StayLength staylength = request.getDate();
	    dayList = staylength.getDatesOfStay();
	
	    staylength.getDaysBetweenDates();
	
	    for(int i=0; i< staylength.getDaysBetweenDates(); i++)
	    {
	    	hotel.getHotelID();
	    	//UPDATE Dates SET "010615"=175 WHERE hotelID = 10;
	    	
		    String updateSQL="UPDATE Dates SET \"" + dayList.get(i) + "\""+ ">=? WHERE hotelID=?;";

		    try {
			      //Class.forName(DB_DRIVER);
			      c = ConnectionDB.getDBConnection(DB_DRIVER, DB_CONNECTION);
			      
			      statement = c.prepareStatement(updateSQL);
			      
			      statement.setInt(1, hotel.getHotelID());
			      statement.setInt(2, hotel.getHotelID());
			  
			      ResultSet rs = statement.executeQuery();
	
		      rs.close();
		      statement.close();
		      c.close();
		    }
		    
		    catch ( Exception e ) {
		      System.err.println( e.getClass().getName() + ": " + e.getMessage() );
		      System.exit(0);
		    } 
	    }
	    
	    
	}
}